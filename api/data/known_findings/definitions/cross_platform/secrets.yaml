findings:
  - id: secret_aws_access_key
    platform: cross_platform
    title: "AWS Access Key Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.8
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      An AWS Access Key ID has been found in the application. AWS access keys provide
      programmatic access to AWS services and can be used to access any resource the
      associated IAM user or role has permissions for.
    impact: |
      Attackers can use the exposed credentials to access AWS services, potentially
      leading to data exfiltration, resource abuse, crypto-mining, or complete cloud
      infrastructure compromise depending on the associated permissions.
    remediation: |
      Immediately rotate the exposed credentials. Remove hardcoded keys from the
      application. Use AWS Cognito for mobile app authentication or temporary
      credentials via STS AssumeRole.
    detection_patterns:
      - type: regex
        pattern: "AKIA[0-9A-Z]{16}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - xml

          - plist
      - type: regex
        pattern: "aws_access_key_id\\s*[=:]\\s*[\"\\']?[A-Z0-9]{20}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - yaml

          - properties
    poc_commands:
      - type: bash
        command: "aws sts get-caller-identity --access-key-id AKIAEXAMPLE --secret-access-key SECRET"
        description: "Verify if credentials are valid"
      - type: bash
        command: "enumerate-iam --access-key AKIAEXAMPLE --secret-key SECRET"
        description: "Enumerate IAM permissions"
    remediation_code:
      - language: java
        code: |
          // Use AWS Cognito Identity Pool
          CognitoCachingCredentialsProvider credentialsProvider = new CognitoCachingCredentialsProvider(
              context,
              "us-east-1:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", // Identity pool ID
              Regions.US_EAST_1
          );

          AmazonS3Client s3 = new AmazonS3Client(credentialsProvider);
        description: "Use Cognito for AWS credentials"
    remediation_resources:
      - title: "AWS Security Best Practices for Mobile"
        url: "https://docs.aws.amazon.com/prescriptive-guidance/latest/patterns/configure-secure-access-to-aws-from-a-mobile-application.html"
        type: documentation
      - title: "AWS Cognito Developer Guide"
        url: "https://docs.aws.amazon.com/cognito/latest/developerguide/what-is-amazon-cognito.html"
        type: documentation
    attack_path_entry_point: true
    attack_path_enables:
      - cloud_access
      - data_exfiltration
      - resource_abuse
    mitre_mobile_techniques:
      - T1552
    tags:
      - secrets
      - aws
      - cloud
      - credentials

  - id: secret_aws_secret_key
    platform: cross_platform
    title: "AWS Secret Access Key Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.8
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      An AWS Secret Access Key has been found in the application. Combined with an
      Access Key ID, this provides full programmatic access to AWS services.
    impact: |
      Complete access to AWS services as the associated IAM user or role. Potential
      for data theft, infrastructure compromise, and significant financial impact.
    remediation: |
      Immediately rotate credentials. Remove from codebase. Use AWS Cognito or
      backend proxy for AWS service access from mobile apps.
    detection_patterns:
      - type: regex
        pattern: "aws_secret_access_key\\s*[=:]\\s*[\"\\']?[A-Za-z0-9/+=]{40}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - yaml

          - properties
      - type: regex
        pattern: "[\"\\']?[A-Za-z0-9/+=]{40}[\"\\']?\\s*(#|//|--)?.*secret"
        file_types:

          - java

          - kt

          - swift

          - js
    attack_path_entry_point: true
    attack_path_enables:
      - cloud_access
      - data_exfiltration
    tags:
      - secrets
      - aws
      - cloud
      - credentials

  - id: secret_google_api_key
    platform: cross_platform
    title: "Google API Key Exposed"
    category: "Secrets"
    severity: high
    cvss_score: 7.5
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      A Google API key has been found in the application. Depending on the enabled APIs
      and restrictions, this key could provide access to Google Cloud services, Maps,
      Firebase, or other Google APIs.
    impact: |
      Attackers can abuse the API key to make requests on behalf of the application,
      potentially accessing paid services, exceeding quotas, or accessing data
      depending on the key's permissions.
    remediation: |
      Restrict the API key to specific APIs, referrers, and IP addresses. Use separate
      keys for different platforms. Consider using OAuth for sensitive operations.
    detection_patterns:
      - type: regex
        pattern: "AIza[0-9A-Za-z_-]{35}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - xml

          - plist
    poc_commands:
      - type: bash
        command: "curl 'https://maps.googleapis.com/maps/api/geocode/json?address=test&key=API_KEY'"
        description: "Test if API key works for Maps"
      - type: bash
        command: "curl 'https://www.googleapis.com/customsearch/v1?key=API_KEY&q=test'"
        description: "Test if API key works for other services"
    remediation_code:
      - language: json
        code: |
          {
            "restrictions": {
              "browserKeyRestrictions": {
                "allowedReferrers": ["*.example.com/*"]
              },
              "androidKeyRestrictions": {
                "allowedApplications": [
                  {"sha1Fingerprint": "...", "packageName": "com.example.app"}
                ]
              }
            }
          }
        description: "Add API key restrictions"
    remediation_resources:
      - title: "Google Cloud - API Key Best Practices"
        url: "https://cloud.google.com/docs/authentication/api-keys"
        type: documentation
    attack_path_entry_point: true
    attack_path_enables:
      - api_abuse
      - quota_exhaustion
    tags:
      - secrets
      - google
      - api_key
      - cloud

  - id: secret_firebase_config
    platform: cross_platform
    title: "Firebase Configuration Exposed"
    category: "Secrets"
    severity: medium
    cvss_score: 5.3
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
    cwe_id: "CWE-200"
    cwe_name: "Exposure of Sensitive Information to an Unauthorized Actor"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      Firebase configuration data has been found in the application. While some Firebase
      config is meant to be public, exposed configuration can reveal project structure
      and may indicate improperly secured Firebase services.
    impact: |
      Attackers can identify the Firebase project and potentially access misconfigured
      Realtime Database, Firestore, or Storage if security rules are not properly set.
    remediation: |
      Ensure Firebase Security Rules are properly configured. Use Firebase Authentication
      for access control. Audit rules to prevent public read/write access.
    detection_patterns:
      - type: regex
        pattern: 'firebaseio\.com'
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - xml

          - plist
      - type: regex
        pattern: 'firebase.*apiKey'
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "curl 'https://PROJECT-ID.firebaseio.com/.json'"
        description: "Check if Firebase DB is publicly readable"
      - type: bash
        command: "curl -X PUT 'https://PROJECT-ID.firebaseio.com/test.json' -d '{\"test\":\"data\"}'"
        description: "Check if Firebase DB is publicly writable"
    remediation_code:
      - language: json
        code: |
          // Firebase Realtime Database Rules
          {
            "rules": {
              ".read": "auth != null",
              ".write": "auth != null",
              "users": {
                "$uid": {
                  ".read": "$uid === auth.uid",
                  ".write": "$uid === auth.uid"
                }
              }
            }
          }
        description: "Secure Firebase rules"
    remediation_resources:
      - title: "Firebase Security Rules"
        url: "https://firebase.google.com/docs/rules"
        type: documentation
    attack_path_entry_point: true
    attack_path_enables:
      - firebase_access
      - data_exfiltration
    tags:
      - secrets
      - firebase
      - google
      - database

  - id: secret_private_key_rsa
    platform: cross_platform
    title: "RSA Private Key Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.8
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
    cwe_id: "CWE-321"
    cwe_name: "Use of Hard-coded Cryptographic Key"
    owasp_masvs_category: "MASVS-CRYPTO"
    owasp_masvs_control: "MASVS-CRYPTO-1"
    owasp_mastg_test: "MASTG-TEST-0013"
    description: |
      An RSA private key has been found embedded in the application. Private keys
      should never be included in client applications as they can be easily extracted.
    impact: |
      Attackers can use the private key to decrypt data encrypted with the corresponding
      public key, forge digital signatures, or impersonate the key owner in TLS
      connections.
    remediation: |
      Remove private keys from the application. Use asymmetric encryption where only
      the public key is embedded. Store private keys on secure backend servers.
    detection_patterns:
      - type: regex
        pattern: '-----BEGIN RSA PRIVATE KEY-----'
        file_types:

          - java

          - kt

          - swift

          - js

          - pem

          - txt
      - type: regex
        pattern: '-----BEGIN PRIVATE KEY-----'
        file_types:

          - java

          - kt

          - swift

          - js

          - pem

          - txt
    poc_commands:
      - type: bash
        command: "openssl rsa -in private.pem -text -noout"
        description: "Verify and analyze private key"
    remediation_resources:
      - title: "OWASP - Key Management Cheat Sheet"
        url: "https://cheatsheetseries.owasp.org/cheatsheets/Key_Management_Cheat_Sheet.html"
        type: documentation
    attack_path_entry_point: true
    attack_path_enables:
      - impersonation
      - data_decryption
      - signature_forgery
    tags:
      - secrets
      - private_key
      - rsa
      - cryptography

  - id: secret_github_token
    platform: cross_platform
    title: "GitHub Token Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.1
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      A GitHub personal access token or OAuth token has been found in the application.
      These tokens provide access to GitHub repositories and APIs based on the token's
      scope.
    impact: |
      Attackers can access private repositories, modify code, create releases, or
      access organization data depending on token permissions.
    remediation: |
      Revoke the exposed token immediately. Use GitHub Apps or OAuth flow with backend
      for GitHub API access from mobile apps.
    detection_patterns:
      - type: regex
        pattern: "ghp_[0-9a-zA-Z]{36}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "github_pat_[0-9a-zA-Z]{22}_[0-9a-zA-Z]{59}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "gho_[0-9a-zA-Z]{36}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "curl -H 'Authorization: token TOKEN' https://api.github.com/user"
        description: "Verify token and check scope"
    attack_path_entry_point: true
    attack_path_enables:
      - code_access
      - repository_modification
    tags:
      - secrets
      - github
      - token
      - vcs

  - id: secret_stripe_key
    platform: cross_platform
    title: "Stripe API Key Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.1
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      A Stripe secret key (sk_live or sk_test) has been found in the application.
      Secret keys should only exist on secure backend servers, never in client code.
    impact: |
      Attackers can access customer data, process refunds, transfer funds, or perform
      other Stripe operations depending on the key's permissions.
    remediation: |
      Rotate the Stripe key immediately. Only use publishable keys (pk_) in mobile apps.
      Process all payments through a secure backend.
    detection_patterns:
      - type: regex
        pattern: "sk_(live|test)_[0-9a-zA-Z]{24,}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "rk_(live|test)_[0-9a-zA-Z]{24,}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "curl https://api.stripe.com/v1/charges -u sk_xxx:"
        description: "Test API key validity"
    remediation_code:
      - language: java
        code: |
          // Only use publishable key in mobile app
          Stripe.init(context, "pk_live_xxxxx");

          // Process payments through your backend
          // Backend endpoint handles Stripe secret key
        description: "Use only publishable keys in mobile"
    remediation_resources:
      - title: "Stripe - API Key Security"
        url: "https://stripe.com/docs/keys"
        type: documentation
    attack_path_entry_point: true
    attack_path_enables:
      - payment_fraud
      - data_theft
      - financial_loss
    tags:
      - secrets
      - stripe
      - payment
      - api_key

  - id: secret_slack_token
    platform: cross_platform
    title: "Slack Token Exposed"
    category: "Secrets"
    severity: high
    cvss_score: 7.5
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      A Slack token (bot, user, or webhook) has been found in the application. These
      tokens provide access to Slack workspaces based on the token's scope.
    impact: |
      Attackers can read messages, access files, send messages as the bot/user, or
      access workspace data depending on token permissions.
    remediation: |
      Revoke the token immediately. Use OAuth flow with backend for Slack API access.
      Webhook URLs should be stored server-side.
    detection_patterns:
      - type: regex
        pattern: "xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "hooks\\.slack\\.com/services/T[A-Z0-9]+/B[A-Z0-9]+/[a-zA-Z0-9]+"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "curl -H 'Authorization: Bearer xoxb-xxx' https://slack.com/api/auth.test"
        description: "Test Slack token validity"
    attack_path_entry_point: true
    attack_path_enables:
      - message_access
      - workspace_data
    tags:
      - secrets
      - slack
      - token
      - communication

  - id: secret_twilio_credentials
    platform: cross_platform
    title: "Twilio Credentials Exposed"
    category: "Secrets"
    severity: high
    cvss_score: 7.5
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      Twilio account credentials (Account SID and Auth Token) have been found in the
      application. These credentials provide full access to the Twilio account.
    impact: |
      Attackers can send SMS/calls, access message history, and abuse the account for
      spam or phishing, potentially causing significant financial charges.
    remediation: |
      Rotate credentials immediately. Use Twilio Functions or your backend to proxy
      Twilio API calls from mobile apps.
    detection_patterns:
      - type: regex
        pattern: "AC[a-z0-9]{32}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: 'twilio.*auth.*token'
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "curl -u ACCOUNT_SID:AUTH_TOKEN https://api.twilio.com/2010-04-01/Accounts/ACCOUNT_SID.json"
        description: "Test Twilio credentials"
    attack_path_entry_point: true
    attack_path_enables:
      - sms_abuse
      - call_abuse
      - financial_loss
    tags:
      - secrets
      - twilio
      - sms
      - communication

  - id: secret_jwt_secret
    platform: cross_platform
    title: "JWT Secret Key Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.8
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
    cwe_id: "CWE-321"
    cwe_name: "Use of Hard-coded Cryptographic Key"
    owasp_masvs_category: "MASVS-CRYPTO"
    owasp_masvs_control: "MASVS-CRYPTO-1"
    owasp_mastg_test: "MASTG-TEST-0013"
    description: |
      A JWT signing secret has been found in the application. This secret is used to
      sign and verify JWT tokens. Exposure allows forging arbitrary tokens.
    impact: |
      Attackers can forge JWT tokens with any claims, bypassing authentication and
      authorization, potentially gaining admin access or impersonating any user.
    remediation: |
      Rotate the JWT secret immediately. Never store JWT secrets in mobile apps.
      Validate tokens on the backend only.
    detection_patterns:
      - type: regex
        pattern: "jwt[_-]?secret\\s*[=:]\\s*[\"\\'][^\"\\']{16,}"
        file_types:

          - java

          - kt

          - swift

          - js

          - json

          - yaml
    poc_commands:
      - type: bash
        command: "python3 -c \"import jwt; print(jwt.encode({'admin':True}, 'SECRET', algorithm='HS256'))\""
        description: "Forge JWT with exposed secret"
    attack_path_entry_point: true
    attack_path_enables:
      - authentication_bypass
      - privilege_escalation
      - impersonation
    tags:
      - secrets
      - jwt
      - authentication
      - token

  - id: secret_database_connection
    platform: cross_platform
    title: "Database Connection String Exposed"
    category: "Secrets"
    severity: critical
    cvss_score: 9.8
    cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"
    cwe_id: "CWE-798"
    cwe_name: "Use of Hard-coded Credentials"
    owasp_masvs_category: "MASVS-STORAGE"
    owasp_masvs_control: "MASVS-STORAGE-14"
    owasp_mastg_test: "MASTG-TEST-0043"
    description: |
      A database connection string with credentials has been found in the application.
      Mobile apps should never connect directly to backend databases.
    impact: |
      Direct database access allows attackers to read, modify, or delete all data in
      the database, potentially compromising the entire application's data.
    remediation: |
      Remove database connection strings from mobile apps. Use API endpoints on a
      secure backend for all database operations.
    detection_patterns:
      - type: regex
        pattern: "mongodb(\\+srv)?://[^:]+:[^@]+@"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "postgres(ql)?://[^:]+:[^@]+@"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
      - type: regex
        pattern: "mysql://[^:]+:[^@]+@"
        file_types:

          - java

          - kt

          - swift

          - js

          - json
    poc_commands:
      - type: bash
        command: "mongosh 'mongodb://user:pass@host/db'"
        description: "Test MongoDB connection"
      - type: bash
        command: "psql 'postgresql://user:pass@host/db'"
        description: "Test PostgreSQL connection"
    attack_path_entry_point: true
    attack_path_enables:
      - data_theft
      - data_modification
      - complete_compromise
    tags:
      - secrets
      - database
      - connection_string
      - credentials
